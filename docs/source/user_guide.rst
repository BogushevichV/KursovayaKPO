Руководство пользователя
========================

Вход в систему
--------------

1. **Запустите приложение** через `Main.py`
2. **Выберите язык** в правом верхнем углу
3. **Нажмите "Войти как пользователь"**

.. figure:: /_static/screenshots/user_login.png
   :width: 400px
   :align: center
   :alt: Окно входа пользователя

   Окно входа пользователя

4. **Введите учетные данные:**
   - Логин пользователя
   - Пароль

5. **Нажмите "Войти"**

Создание экзаменационной ведомости
-----------------------------------

После входа вы попадете в основное окно приложения.

### 1. Заполнение основных данных

.. code-block:: python
   :linenos:
   :caption: Пример заполнения данных в Examination_Report_App.py

   # Установка номера группы
   self.group_number_input.setText("КПО-101")

   # Выбор курса
   self.course_combo.setCurrentText("3")

   # Выбор семестра
   self.semester_combo.setCurrentText("1 семестр")

   # Ввод названия предмета
   self.subject_input.setText("Конструирование ПО")

### 2. Импорт студентов из Excel

Используйте модуль `Excel_Importer.py`:

.. literalinclude:: ../../Excel_Importer.py
   :language: python
   :linenos:
   :caption: Excel_Importer.py - импорт данных

Процесс импорта:
1. Нажмите **"Импорт из Excel"**
2. Выберите файл Excel (.xlsx или .xls)
3. Приложение загрузит данные студентов

Формат Excel файла:
- **Столбец A:** Порядковый номер (необязательно)
- **Столбец B:** Фамилия, инициалы (обязательно)
- **Столбец C:** № зачетной книжки (обязательно)

### 3. Ввод оценок

Для ввода оценок используется специальный делегат `Grade_Item_Delegate.py`:

.. literalinclude:: ../../Grade_Item_Delegate.py
   :language: python
   :linenos:
   :caption: GradeItemDelegate - валидация оценок

Особенности:
- **Валидация:** Только числа от 1 до 10
- **Форматирование:** Выравнивание по центру
- **Ограничение:** Максимум 2 символа

### 4. Заполнение дополнительной информации

.. code-block:: none

   Номер ведомости: [автоматически или вручную]
   Вид образования: Общее высшее образование
   Форма обучения: дневная/заочная
   Форма аттестации: экзамен/зачёт/дифференцированный зачёт
   Факультет: [выберите из списка]
   Преподаватель: [ФИО преподавателя]
   Декан: [ФИО декана]

### 5. Сохранение ведомости

Нажмите **"Составить ведомость"** для сохранения.

Процесс сохранения:
1. **Валидация данных:** Проверка заполнения всех обязательных полей
2. **Сохранение в БД:** Данные сохраняются в таблицу `statements`
3. **Генерация отчета:** Создается PDF/Excel документ (требуется реализация)

Поиск данных
------------

### Поиск группы

1. Введите номер группы
2. Нажмите **"Найти группу"**
3. Система покажет список студентов группы

### Поиск предмета

1. Введите название предмета
2. Выберите курс и семестр
3. Нажмите **"Найти предмет"**
4. Система покажет успеваемость по предмету

Очистка формы
-------------

Нажмите **"Очистить"** для сброса всех полей формы.

Выход из системы
----------------

Нажмите **"Назад"** для возврата в окно входа.

Безопасность
------------

- **Ограничение попыток входа:** 3 попытки
- **Блокировка при превышении:** Доступ запрещен
- **Хранение паролей:** В хэшированном виде с солью

Пример обработки входа из `User_Window.py`:

.. code-block:: python
   :linenos:

   # Проверка учетных данных
   def authenticate_user(self, login, password):
       if not login or not password:
           QMessageBox.warning(self, self.tr("Ошибка"),
                              self.tr("Введите логин и пароль"))
           return False

       try:
           # Аутентификация через DBAuthenticator
           if self.db_auth.authenticate_user(login, password):
               return True
           else:
               self.login_attempts -= 1
               if self.login_attempts > 0:
                   QMessageBox.warning(self, self.tr("Ошибка входа"),
                                      self.tr("Неверные данные! Осталось попыток: {}")
                                      .format(self.login_attempts))
               else:
                   QMessageBox.critical(self, self.tr("Доступ запрещен"),
                                       self.tr("Превышено количество попыток входа!"))
               return False
       except Exception as e:
           QMessageBox.critical(self, self.tr("Ошибка аутентификации"),
                               self.tr("Произошла ошибка при проверке учетных данных:\n{}")
                               .format(str(e)))
           return False